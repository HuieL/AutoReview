{"name": "ICLR_2017_146.pdf", "metadata": {"source": "CRF", "title": "DEEP INFORMATION PROPAGATION", "authors": ["Samuel S. Schoenholz", "Justin Gilmer", "Surya Ganguli"], "emails": [], "sections": [{"heading": "1 INTRODUCTION", "text": "Deep neural network architectures have become ubiquitous in machine learning. The success of deep networks is due to the fact that they are highly expressive (Montufar et al., 2014) while simultaneously being relatively easy to optimize (Choromanska et al., 2015; Goodfellow et al., 2014) with strong generalization properties (Recht et al., 2015). Consequently, developments in machine learning often accompany improvements in our ability to train increasingly deep networks. Despite this, designing novel network architectures is frequently equal parts art and science. This is, in part, because a general theory for neural networks that might inform design decisions has lagged behind the feverish pace of design.\nA pair of recent papers (Poole et al., 2016; Raghu et al., 2016) demonstrated that random neural networks are exponentially expressive in their depth. Central to their approach was the consideration of networks after random initialization, whose weights and biases were i.i.d. Gaussian distributed. In particular the paper by Poole et al. (2016) developed a \u201cmean field\u201d formalism for treating wide, untrained, neural networks. They showed that these mean field networks exhibit an order-to-chaos transition as a function of the weight and bias variances. Notably the mean field formalism is not closely tied to a specific choice of activation function or loss.\nIn this paper, we demonstrate the existence of several characteristic \u201cdepth\u201d scales that emerge naturally and control signal propagation in these random networks. We then show that one of these depth scales, \u03bec, diverges at the boundary between order and chaos. This result is insensitive to many architectural decisions (such as choice of activation function) and will generically be true at any order-to-chaos transition. We then extend these results to include dropout and we show that even small amounts of dropout destroys the order-to-chaos critical point and consequently removes the divergence in \u03bec. Together these results bound the depth to which signal may propagate through random neural networks.\nWe then develop a corresponding mean field model for gradients and we show that a duality exists between the forward propagation of signals and the backpropagation of gradients. The ordered and chaotic phases that Poole et al. (2016) identified correspond to regions of vanishing and exploding gradients, respectively. We demonstrate the validity of this mean field theory by computing gradients of random networks on MNIST. This provides a formal explanation of the \u2018vanishing gradients\u2019\n\u2217Work done as a member of the Google Brain Residency program (g.co/brainresidency)\nphenomenon that has long been observed in neural networks (Bengio et al., 1993). We continue to show that the covariance between two gradients is controlled by the same depth scale that limits correlated signal propagation in the forward direction.\nFinally, we hypothesize that a necessary condition for a random neural network to be trainable is that information should be able to pass through it. Thus, the depth-scales identified here bound the set of hyperparameters that will lead to successful training. To test this ansatz we train ensembles of deep, fully connected, feed-forward neural networks of varying depth on MNIST and CIFAR10, with and without dropout. Our results confirm that neural networks are trainable precisely when their depth is not much larger than \u03bec. This result is dataset independent and is, therefore, a universal function of network architecture.\nA corollary of these result is that asymptotically deep neural networks should be trainable provided they are initialized sufficiently close to the order-to-chaos transition. The notion of \u201cedge of chaos\u201d initialization has been explored previously. Such investigations have been both direct as in Bertschinger et al. (2005); Glorot & Bengio (2010) or indirect, through initialization schemes that favor deep signal propagation such as batch normalization (Ioffe & Szegedy, 2015), orthogonal matrix initialization (Saxe et al., 2014), random walk initialization (Sussillo & Abbott, 2014), composition kernels (Daniely et al., 2016), or residual network architectures (He et al., 2015). The novelty of the work presented here is two-fold. First, our framework predicts the depth at which networks may be trained even far from the order-to-chaos transition. While a skeptic might ask when it would be profitable to initialize a network far from criticality, we respond by noting that there are architectures (such as neural networks with dropout) where no critical point exists and so this more general framework is needed. Second, our work provides a formal, as opposed to intuitive, explanation for why very deep networks can only be trained near the edge of chaos."}, {"heading": "2 BACKGROUND", "text": "We begin by recapitulating the mean-field formalism developed in Poole et al. (2016). Consider a fully-connected, untrained, feed-forward, neural network of depth L with layer width Nl and some nonlinearity \u03c6 : R \u2192 R. Since this is an untrained neural network we suppose that its weights and biases are respectively i.i.d. as W lij \u223c N(0, \u03c32w/Nl) and bli \u223c N(0, \u03c32b ). Notationally we set zli to be the pre-activations of the lth layer and yl+1i to be the activations of that layer. Finally, we take the input to the network to be y0i = xi. The propagation of a signal through the network is described by the pair of equations,\nzli = \u2211 j W lijy l j + b l i y l+1 i = \u03c6(z l i). (1)\nSince the weights and biases are randomly distributed, these equations define a probability distribution on the activations and pre-activations over an ensemble of untrained neural networks. The \u201cmean-field\u201d approximation is then to replace zli by a Gaussian whose first two moments match those of zli. For the remainder of the paper we will take the mean field approximation as given.\nConsider first the evolution of a single input, xi;a, as it evolves through the network (as quantified by yli;a and z l i;a). Since the weights and biases are independent with zero mean, the first two moments of the pre-activations in the same layer will be,\nE[zli;a] = 0 E[zli;azlj;a] = qlaa\u03b4ij (2)\nwhere \u03b4ij is the Kronecker delta. Here qlaa is the variance of the pre-activations in the lth layer due to an input xi;a and it is described by the recursion relation,\nqlaa = \u03c3 2 w\n\u222b Dz\u03c62 (\u221a ql\u22121aa z ) + \u03c32b (3)\nwhere \u222b Dz = 1\u221a\n2\u03c0\n\u222b dze\u2212 1 2 z 2\nis the measure for a standard Gaussian distribution. Together these equations completely describe the evolution of a single input through a mean field neural network. For any choice of \u03c32w and \u03c3 2 b with bounded \u03c6, eq. 3 has a fixed point at q \u2217 = liml\u2192\u221e qlaa.\nThe propagation of a pair of signals, x0i;a and x 0 i;b, through this network can be understood similarly. Here the mean pre-activations are trivially the same as in the single-input case. The independence\nof the weights and biases implies that the covariance between different pre-activations in the same layer will be given by, E[zli;azlj;b] = qlab\u03b4ij . The covariance, qlab, will be given by the recurrence relation,\nqlab = \u03c3 2 w \u222b Dz1Dz2\u03c6(u1)\u03c6(u2) + \u03c32b (4)\nwhere u1 = \u221a ql\u22121aa z1 and u2 = \u221a ql\u22121bb ( cl\u22121ab z1 + \u221a 1\u2212 (cl\u22121ab )2z2 ) , with clab = q l ab/ \u221a qlaaq l bb,\nare Gaussian approximations to the pre-activations in the preceding layer with the correct covariance matrix. Moreover clab is the correlation between the two inputs after l layers.\nExamining eq. 4 it is clear that c\u2217 = 1 is a fixed point of the recurrence relation. To determine whether or not the c\u2217 = 1 is an attractive fixed point the quantity,\n\u03c71 = \u2202clab \u2202cl\u22121ab = \u03c32w\n\u222b Dz [ \u03c6\u2032 (\u221a q\u2217z )]2\n(5)\nis introduced. Poole et al. (2016) note that the c\u2217 = 1 fixed point is stable if \u03c71 < 1 and is unstable otherwise. Thus, \u03c71 = 1 represents a critical line separating an ordered phase (in which c\u2217 = 1 and all inputs end up asymptotically correlated) and a chaotic phase (in which c\u2217 < 1 and all inputs end up asymptotically decorrelated). For the case of \u03c6 = tanh, the phase diagram in fig. 1 (a) is observed."}, {"heading": "3 ASYMPTOTIC EXPANSIONS AND DEPTH SCALES", "text": "Our first contribution is to demonstrate the existence of two depth-scales that arise naturally within the framework of mean field neural networks. Motivating the existence of these depth-scales, we iterate eq. 3 and 4 until convergence for many values of \u03c32w between 0.1 and 3.0 and with \u03c3 2 b = 0.05 starting with q0aa = q 0 bb = 0.8 and c 0 ab = 0.6. We see, in fig. 1 (b) and (c), that the manner in which both qlaa approaches q \u2217 and clab approaches c\n\u2217 is exponential over many orders of magnitude. We therefore anticipate that asymptotically |qlaa \u2212 q\u2217| \u223c e\u2212l/\u03beq and |clab \u2212 c\u2217| \u223c e\u2212l/\u03bec for sufficiently large l. Here, \u03beq and \u03bec define depth-scales over which information may propagate about the magnitude of a single input and the correlation between two inputs respectively.\nWe will presently prove that qlaa and c l ab are asymptotically exponential. In both cases we will use the same fundamental strategy wherein we expand one of the recurrence relations (either eq. 3 or eq. 4) about its fixed point to get an approximate \u201casymptotic\u201d recurrence relation. We find that this asymptotic recurrence relation in turn implies exponential decay towards the fixed point over a depth-scale, \u03bex.\nWe first analyze eq. 3 and identify a depth-scale at which information about a single input may propagate. Let qlaa = q \u2217 + l. By construction so long as liml\u2192\u221e qlaa = q \u2217 exists it follows that\nl \u2192 0 as l\u2192\u221e. Eq. 3 may be expanded to lowest order in l to arrive at an asymptotic recurrence relation (see Appendix 7.1),\nl+1 = l [ \u03c71 + \u03c3 2 w \u222b Dz\u03c6\u2032\u2032 (\u221a q\u2217z ) \u03c6 (\u221a q\u2217z )] +O ( ( l)2 ) . (6)\nNotably, the term multiplying l is a constant. It follows that for large l the asymptotic recurrence relation has an exponential solution, l \u223c e\u2212l/\u03beq , with \u03beq given by\n\u03be\u22121q = \u2212 log [ \u03c71 + \u03c3 2 w \u222b Dz\u03c6\u2032\u2032 (\u221a q\u2217z ) \u03c6 (\u221a q\u2217z )] . (7)\nThis establishes \u03beq as a depth scale that controls how deep information from a single input may penetrate into a random neural network.\nNext, we consider eq. 4. Using a similar argument (detailed in Appendix 7.2) we can expand about clab = c \u2217 + l to find an asymptotic recurrence relation,\nl+1 = l [ \u03c32w \u222b Dz1Dz2\u03c6\u2032(u\u22171)\u03c6\u2032(u\u22172) ] +O(( l)2). (8)\nHere u\u22171 = \u221a q\u2217z1 and u\u22172 = \u221a q\u2217(c\u2217z1 + \u221a 1\u2212 (c\u2217)2z2). Thus, once again, we expect that for large l this recurrence will have an exponential solution, l \u223c e\u2212l/\u03bec , with \u03bec given by\n\u03be\u22121c = \u2212 log [ \u03c32w \u222b Dz1Dz2\u03c6\u2032(u\u22171)\u03c6\u2032(u\u22172) ] . (9)\nIn the ordered phase c\u2217 = 1 and so \u03be\u22121c = \u2212 log\u03c71. Since the transition between order and chaos occurs when \u03c71 = 1 it follows that \u03bec diverges at any order-to-chaos transition so long as q\u2217 and c\u2217 exist.\nThese results can be investigated intuitively by plotting cl+1ab vs c l ab in fig. 2 (a). In the ordered phase there is only a single fixed point, clab = 1. In the chaotic regime we see that a second fixed point develops and the clab = 1 point becomes unstable. We see that the linearization about the fixed points becomes significantly closer to the trivial map near the order-to-chaos transition.\nTo test these claims we measure \u03beq and \u03bec directly by iterating the recurrence relations for qlaa and clab as before with q 0 aa = q 0 bb = 0.8 and c 0 ab = 0.6. In this case we consider values of \u03c3 2 w between\n0.1 and 3.0 and \u03c32b between 0.01 and 0.3. For each hyperparameter settings we fit the resulting residuals, |qlaa \u2212 q\u2217| and |clab \u2212 c\u2217|, to exponential functions and infer the depth-scale. We then compare this measured depth-scale to that predicted by the asymptotic expansion. The result of this measurement is shown in fig. 2. In general we see that the agreement is quite good. As expected we see that \u03bec diverges at the critical point.\nAs observed in Poole et al. (2016) we see that the depth scale for the propagation of information in a single input, \u03beq , is consistently finite and significantly shorter than \u03bec. To understand why this is the case consider eq. 6 and note that for tanh nonlinearities the second term is always negative. Thus, even as \u03c71 approaches 1 we expect \u03c71 + \u03c32w \u222b Dz\u03c6\u2032\u2032(\u221aq\u2217z)\u03c6(\u221aq\u2217z) to be substantially smaller than 1."}, {"heading": "3.1 DROPOUT", "text": "The mean field formalism can be extended to include dropout. The main contribution here will be to argue that even infinitesimal amounts of dropout destroys the mean field critical point, and therefore limits the trainable network depth. In the presence of dropout the propagation equation, eq. 1, becomes,\nzli = 1\n\u03c1 \u2211 j W lijp l jy l j + b l i (10)\nwhere pj \u223c Bernoulli(\u03c1) and \u03c1 is the dropout rate. As is typically the case we have re-scaled the sum by \u03c1\u22121 so that the mean of the pre-activation is invariant with respect to our choice of dropout rate.\nFollowing a similar procedure to the original mean field calculation consider the fate of two inputs, x0i;a and x 0 i;b, as they are propagated through such a random network. We take the dropout masks to be chosen independently for the two inputs mimicking the manner in which dropout is employed in practice. With dropout the diagonal term in the covariance matrix will be (see Appendix 7.3),\nq\u0304laa = \u03c32w \u03c1\n\u222b Dz\u03c62 (\u221a q\u0304l\u22121aa z ) + \u03c32b . (11)\nThe variance of a single input with dropout will therefore propagate in an identical fashion to the vanilla case with a re-scaling \u03c32w \u2192 \u03c32w/\u03c1. Intuitively, this result implies that, for the case of a single input, the presence of dropout simply increases the effective variance of the weights.\nComputing the off-diagonal term of the covariance matrix similarly (see Appendix 7.4),\nq\u0304lab = \u03c3 2 w \u222b Dz1Dz2\u03c6(u\u03041)\u03c6(u\u03042) + \u03c32b (12)\nwith u\u03041, u\u03042, and c\u0304lab defined by analogy to the mean field equations without dropout. Here, unlike in the case of a single input, the recurrence relation is identical to the recurrence relation without dropout. To see that c\u0304\u2217 = 1 is no longer a fixed point of these dynamics consider what happens to eq. 12 when we input c\u0304l = 1. For simplicity, we leverage the short range of \u03beq to replace q\u0304laa = q\u0304 l bb = q\u0304 \u2217. We find (see Appendix 7.5),\nc\u0304l+1ab = 1\u2212 1\u2212 \u03c1 \u03c1q\u0304\u2217 \u03c32w\n\u222b Dz\u03c62 (\u221a q\u0304\u2217z ) . (13)\nThe second term is positive for any \u03c1 < 1. This implies that if c\u0304lab = 1 for any l then c\u0304 l+1 ab < 1. Thus, c\u2217 = 1 is not a fixed point of eq. 12 for any \u03c1 < 1. Since eq. 12 is identical in form to eq. 4 it follows that the depth scale for signal propagation with dropout will likewise be given by eq. 9 with the substitutions q\u2217 \u2192 q\u0304\u2217 and c\u2217 \u2192 c\u0304\u2217 computed using eq. 11 and eq. 12 respectively. Importantly, since there is no longer a sharp critical point with dropout we do not expect a diverging depth scale.\nAs in networks without dropout we plot, in fig. 3 (a), the iterative map c\u0304l+1ab as a function of c\u0304 l ab. Most significantly, we see that the c\u0304lab = 1 is no longer a fixed point of the dynamics. Instead, as the dropout rate increases c\u0304lab gets mapped to decreasing values and the fixed point monotonically decreases.\nTo test these results we plot in fig. 3 (b) the asymptotic correlation, c\u2217, as a function of \u03c32w for different values of dropout from \u03c1 = 0.8 to \u03c1 = 1.0. As expected, we see that for all \u03c1 < 1 there is no sharp transition between c\u2217 = 1 and c\u2217 < 1. Moreover as the dropout rate increases the correlation c\u2217 monotonically decreases. Intuitively this makes sense. Identical inputs passed through two different dropout masks will become increasingly dissimilar as the dropout rate increases. In fig. 3 (c) we show the depth scale, \u03bec, as a function of \u03c32w for the same range of dropout probabilities. We find that, as predicted, the depth of signal propagation with dropout is drastically reduced and, importantly, there is no longer a divergence in \u03bec. Increasing the dropout rate continues to decrease the correlation depth for constant \u03c32w."}, {"heading": "4 GRADIENT BACKPROPAGATION", "text": "There is a duality between the forward propagation of signals and the backpropagation of gradients. To elucidate this connection consider the backpropagation equations given a loss E,\n\u2202E\n\u2202W lij = \u03b4li\u03c6(z l\u22121 j ) \u03b4 l i = \u03c6 \u2032(zli) \u2211 j \u03b4l+1j W l+1 ji (14)\nwith the identification \u03b4li = \u2202E/\u2202z l i. Within mean field theory, it is clear that the scale of fluctuations of the gradient of weights in a layer will be proportional to E[(\u03b4li)2] (see appendix 7.6). In contrast to the pre-activations in forward propagation (eq. 1), the \u03b4li will typically not be Gaussian distributed even in the large layer width limit.\nNonetheless, we can work out a recurrence relation for the variance of the error, q\u0303 laa = E[(\u03b4li)2], leveraging the Gaussian ansatz on the pre-activations. In order to do this, however, we must first make an additional approximation that the weights used during forward propagation are drawn independently from the weights used in backpropagation. This approximation is similar in spirit to the vanilla mean field approximation and is reminiscent of work on feedback alignment (Lillicrap et al., 2014). With this in mind we arrive at the recurrence (see appendix 7.7),\nq\u0303 laa = q\u0303 l+1 aa Nl+1 Nl \u03c71. (15)\nThe presence of \u03c71 in the above equation should perhaps not be surprising. In Poole et al. (2016) they show that \u03c71 is intimately related to the tangent space of a given layer in mean field neural\nnetworks. We note that the backpropagation recurrence features an explicit dependence on the ratio of widths of adjacent layers of the network, Nl+1/Nl. Here we will consider exclusively constant width networks where this factor is unity. For a discussion of the case of unequal layer widths see Glorot & Bengio (2010).\nSince \u03c71 depends only on the asymptotic q\u2217 it follows that for constant width networks we expect eq. 15 to again have an exponential solution with,\nq\u0303 laa = q\u0303 L aae \u2212(L\u2212l)/\u03be\u2207 \u03be\u22121 \u2207 = \u2212 log\u03c71. (16)\nNote that here \u03be\u22121 \u2207 = \u2212 log\u03c71 both above and below the transition. It follows that \u03be\u2207 can be both positive and negative. We conclude that there should be three distinct regimes for the gradients.\n1. In the ordered phase, \u03c71 < 1 and so \u03be\u2207 > 0. We therefore expect gradients to vanish over a depth |\u03be\u2207 |. 2. At criticality, \u03c71 \u2192 1 and so \u03be\u2207 \u2192\u221e. Here gradients should be stable regardless of depth. 3. In the chaotic phase, \u03c71 > 1 and so \u03be\u2207 < 0. It follows that in this regime gradients should\nexplode over a depth |\u03be\u2207 |.\nIntuitively these three regimes make sense. To see this, recall that perturbations to a weight in layer l can alternatively be viewed as perturbations to the pre-activations in the same layer. In the ordered phase both the perturbed signal and the unperturbed signal will be asymptotically mapped to the same point and the derivative will be small. In the chaotic phase the perturbed and unperturbed signals will become asymptotically decorrelated and the gradient will be large.\nTo investigate these predictions we construct deep random networks of depth L = 240 and layerwidth Nl = 300. We then consider the cross-entropy loss of these networks on MNIST. In fig. 4 (a) we plot the layer-by-layer 2-norm of the gradient, ||\u2207W labE|| 2 2, as a function of layer, l, for different values of \u03c32w. We see that ||\u2207W labE|| 2 2 behaves exponentially over many orders of magnitude. Moreover, we see that the gradient vanishes in the ordered phase and explodes in the chaotic phase. We test the quantitative predictions of eq. 16 in fig. 4 (b) where we compare |\u03be\u2207 | as predicted from theory with the measured depth-scale constructed from exponential fits to the gradient data. Here we see good quantitative agreement between the theoretical predictions from mean field random networks and experimentally realized networks. Together these results suggest that the approximations on the backpropagation equations were representative of deep, wide, random networks.\nFinally, we show that the depth scale for correlated signal propagation likewise controls the depth at which information stored in the covariance between gradients can survive. The existence of\nconsistent gradients across similar samples from a training set ought to be especially important for determining whether or not a given neural network architecture can be trained. To establish this depth-scale first note (see Appendix 7.8) that the covariance between gradients of two different inputs, xi;1 and xi;2, will be proportional to (\u2207W lijEa) \u00b7 (\u2207W lijEb) \u223c E[\u03b4 l i;a\u03b4 l i;b] = q\u0303 l ab where Ea is the loss evaluated on xi;a and \u03b4i;a = \u2202Ea/\u2202zli;a are appropriately defined errors.\nIt can be shown (see Appendix 7.9) that q\u0303 lab features the recurrence relation,\nq\u0303 lab = q\u0303 l+1 ab Nl+1 Nl+2 \u03c32w\n\u222b Dz1Dz2\u03c6\u2032(u1)\u03c6\u2032(u2) (17)\nwhere u1 and u2 are defined similarly as for the forward pass. Expanding asymptotically it is clear that to zeroth order in l, q\u0303lab will have an exponential solution with q\u0303 l ab = q\u0303 L abe \u2212(L\u2212l)/\u03bec with \u03bec as defined in the forward pass."}, {"heading": "5 EXPERIMENTAL RESULTS", "text": "Taken together, the results of this paper lead us to the following hypothesis: a necessary condition for a random network to be trained is that information about the inputs should be able to propagate forward through the network, and information about the gradients should be able to propagate backwards through the network. The preceding analysis shows that networks will have this property precisely when the network depth, L, is not much larger than the depth-scale \u03bec. This criterion is data independent and therefore offers a \u201cuniversal\u201d constraint on the hyperparameters that depends on network architecture alone. We now explore this relationship between depth of signal propagation and network trainability empirically.\nTo investigate this prediction, we consider random networks of depth 10 \u2264 L \u2264 300 and 1 \u2264 \u03c32w \u2264 4 with \u03c32b = 0.05. We train these networks using Stochastic Gradient Descent (SGD) and RMSProp\non MNIST and CIFAR10. We use a learning rate of 10\u22123 for SGD when L . 200, 10\u22124 for larger L, and 10\u22125 for RMSProp. These learning rates were selected by grid search between 10\u22126 and 10\u22122 in exponentially spaced steps of size 10. We note that the depth dependence of learning rate was explored in detail in Saxe et al. (2014). In fig. 5 (a)-(d) we color in red the training accuracy that neural networks achieved as a function of \u03c32w and L for different datasets, training time, and choice of minimizer (see Appendix 7.10 for more comparisons). In all cases the neural networks over-fit the data to give a training accuracy of 100% and test accuracies of 98% on MNIST and 55% on CIFAR10. We emphasize that the purpose of this study is to demonstrate trainability as opposed to optimizing test accuracy.\nWe now make the connection between the depth scale, \u03bec, and the maximum trainable depth more precise. Given the arguments in the preceding sections we note that if L = n\u03bec then signal through the network will be attenuated by a factor of en. To understand how much signal can be lost while still allowing for training, we overlay in fig. 5 (a) curves corresponding to n\u03bec from n = 1 to 6. We find that networks appear to be trainable when L . 6\u03bec. It would be interesting to understand why this is the case.\nMotivated by this argument in fig. 5 (b)-(d) in white, dashed, overlay we plot twice the predicted depth scale, 6\u03bec. There is clearly a relationship between the depth of correlated signal propagation and whether or not these networks are trainable. Networks closer to their critical point appear to train more quickly than those further away. Moreover, this relationship has no obvious dependence on dataset, duration of training, or minimizer. We therefore conclude that these bounds on trainable hyperparameters are universal. This in turn implies that to train increasingly deep networks, one must generically be ever closer to criticality.\nNext we consider the effect of dropout. As we showed earlier, even infinitesimal amounts of dropout disrupt the order-to-chaos phase transition and cause the depth scale to become finite. However, since the effect of a single dropout mask is to simply re-scale the weight variance by \u03c32w \u2192 \u03c32w/\u03c1, the gradient magnitude will be stable near criticality, while the input and gradient correlations will not be. This therefore offers a unique opportunity to test whether the relevant depth-scale is |1/ log\u03c71| or \u03bec.\nIn fig. 6 we repeat the same experimental setup as above on MNIST with dropout rates \u03c1 = 0.99, 0.98, and 0.94. We observe, first and foremost, that even extremely modest amounts of dropout limit the maximum trainable depth to about L = 100. We additionally notice that the depth-scale, \u03bec, predicts the trainable region accurately for varying amounts of dropout."}, {"heading": "6 DISCUSSION", "text": "In this paper we have elucidated the existence of several depth-scales that control signal propagation in random neural networks. Furthermore, we have shown that the degree to which a neural network can be trained depends crucially on its ability to propagate information about inputs and gradients\nthrough its full depth. At the transition between order and chaos, information stored in the correlation between inputs can propagate infinitely far through these random networks. This in turn implies that extremely deep neural networks may be trained sufficiently close to criticality. However, our contribution goes beyond advocating for hyperparameter selection that brings random networks to be nearly critical. Instead, we offer a general purpose framework that predicts, at the level of mean field theory, which hyperparameters should allow a network to be trained. This is especially relevant when analyzing schemes like dropout where there is no critical point and which therefore imply an upper bound on trainable network depth.\nAn alternative perspective as to why information stored in the covariance between inputs is crucial for training can be understood by appealing to the correspondence between infinitely wide Bayesian neural networks and Gaussian Processes (Neal, 2012). In particular the covariance, qlab, is intimately related to the kernel of the induced Gaussian Process. It follows that cases in which signal stored in the covariance between inputs may propagate through the network correspond precisely to situations in which the associated Gaussian Process is well defined.\nOur work suggests that it may be fruitful to investigate pre-training schemes that attempt to perturb the weights of a neural network to favor information flow through the network. In principle this could be accomplished through a layer-by-layer local criterion for information flow or by selecting the mean and variance in schemes like batch normalization to maximize the covariance depth-scale.\nThese results suggest that theoretical work on random neural networks can be used to inform practical architectural decisions. However, there is still much work to be done. For instance, the framework developed here does not apply to unbounded activations, such as rectified linear units, where it can be shown that there are phases in which eq. 3 does not have a fixed point. Additionally, the analysis here applies directly only to fully connected feed-forward networks, and will need to be extended to architectures with structured weight matrices such as convolutional networks.\nWe close by noting that in physics it has long been known that, through renormalization, the behavior of systems near critical points can control their behavior even far from the idealized critical case. We therefore make the somewhat bold hypothesis that a broad class of neural network topologies will be controlled by the fully-connected mean field critical point."}, {"heading": "ACKNOWLEDGMENTS", "text": "We thank Ben Poole, Jeffrey Pennington, Maithra Raghu, and George Dahl for useful discussions. We are additionally grateful to RocketAI for introducing us to Temporally Recurrent Online Learning and two-dimensional time."}, {"heading": "7 APPENDIX", "text": "Here we present derivations of results from throughout the paper."}, {"heading": "7.1 SINGLE INPUT DEPTH-SCALE", "text": ""}, {"heading": "Result:", "text": "Consider the recurrence relation for the variance of a single input,\nqlaa = \u03c3 2 w\n\u222b Dz\u03c62 (\u221a ql\u22121aa z ) + \u03c32b (18)\nand a fixed point of the dynamics, q\u2217. qlaa can be expanded about the fixed point to yield the asymptotic recurrence relation,\nl+1 = l [ \u03c71 + \u03c3 2 w \u222b Dz\u03c6\u2032\u2032 (\u221a q\u2217z ) \u03c6 (\u221a q\u2217z )] +O ( ( l)2 ) . (19)\nDerivation:\nWe begin by first expanding to order l,\nq\u2217 + l+1 = \u03c32w\n\u222b Dz [ \u03c6 (\u221a q\u2217 + lz )]2\n+ \u03c32b (20)\n\u2248 \u03c32w \u222b Dz [ \u03c6 (\u221a q\u2217z + 1\n2 lz\u221a q\u2217\n)]2 + \u03c32b (21)\n\u2248 \u03c32w \u222b Dz [ \u03c6 (\u221a q\u2217z ) + 1\n2 lz\u221a q\u2217 \u03c6\u2032 (\u221a q\u2217z )]2 + \u03c32b +O(( l)2) (22)\n\u2248 \u03c32w \u222b Dz\u03c62 (\u221a q\u2217z ) + \u03c32b + l \u03c3\n2 w\u221a q\u2217\n\u222b Dzz\u03c6 (\u221a q\u2217z ) \u03c6\u2032 (\u221a q\u2217z ) +O(( l)2) (23)\n\u2248 q\u2217 + l \u03c3 2 w\u221a q\u2217\n\u222b Dzz\u03c6(\u221aq\u2217z)\u03c6\u2032 (\u221a q\u2217z ) +O(( l)2). (24)\nWe therefore arrive at the approximate reccurence relation,\nl+1 = l \u03c32w\u221a q\u2217\n\u222b Dzz\u03c6(\u221aq\u2217z)\u03c6\u2032 (\u221a q\u2217z ) +O(( l)2). (25)\nUsing the identity, \u222b Dzzf(z) = \u222b Dzf \u2032(z) we can rewrite this asymptotic recurrence relation as,\nl+1 = l [ \u03c32w \u222b Dz [ \u03c6\u2032 (\u221a q\u2217z )]2 + \u03c32w \u222b Dz\u03c6\u2032\u2032 (\u221a q\u2217z ) \u03c6 (\u221a q\u2217z )] +O(( l)2) (26)\n= l [ \u03c71 + \u03c3 2 w \u222b Dz\u03c6\u2032\u2032 (\u221a q\u2217z ) \u03c6 (\u221a q\u2217z )] +O(( l)2) (27)\nas required."}, {"heading": "7.2 TWO INPUT DEPTH-SCALE", "text": ""}, {"heading": "Result:", "text": "Consider the recurrence relation for the co-variance of two input,\nqlab = \u03c3 2 w \u222b Dz1Dz2\u03c6(u1)\u03c6(u2) + \u03c32b , (28)\na correlation between the inputs, clab = q l ab/ \u221a qlaaq l bb, and a fixed point of the dynamics, c\n\u2217. clab can be expanded about the fixed point to yield the asymptotic recurrence relation,\nl+1 = l [ \u03c32w \u222b Dz1Dz2\u03c6\u2032(u1)\u03c6\u2032(u2) ] +O ( ( l)2 ) . (29)"}, {"heading": "Derivation:", "text": "Since the relaxation of qlaa and q l bb to q \u2217 occurs much more quickly than the convergence of qlab we approximate qlaa = q l bb = q\n\u2217 as in Poole et al. (2016). We therefore consider the perturbation qlab/q \u2217 = clab = c \u2217 + l. It follows that we may make the approximation,\nul2 = \u221a q\u2217 ( clabz1 + \u221a 1\u2212 (clab)2z2 ) (30)\n\u2248 \u221aq\u2217 ( c\u2217z1 + \u221a 1\u2212 (c\u2217)2 \u2212 2c\u2217 lz2 ) + \u221a q\u2217 lz1 +O( 2) (31)\n(32)\nWe now consider the case where c\u2217 < 1 and c\u2217 = 1 separately; we will later show that these two results agree with one another. First we consider the case where c\u2217 < 1 in which case we may safely expand the above equation to get,\nul2 = \u221a q\u2217 ( c\u2217z1 + \u221a 1\u2212 (c\u2217)2z2 ) + \u221a q\u2217 l ( z1 \u2212\nc\u2217\u221a 1\u2212 (c\u2217)2 z2\n) +O( 2). (33)\nThis allows us to in turn approximate the recurrence relation,\ncl+1ab = \u03c32w q\u2217\n\u222b Dz1Dz2\u03c6(u\u22171)\u03c6(ul2) + \u03c32b (34)\n\u2248 \u03c3 2 w\nq\u2217\n\u222b Dz1Dz2\u03c6(u\u22171) [ \u03c6(u\u22172) + \u221a q\u2217 l ( z1 \u2212\nc\u2217\u221a 1\u2212 (c\u2217)2 z2\n) \u03c6\u2032(u\u22172) ] + \u03c32b +O( 2)\n(35) = c\u2217 + \u03c32w\u221a q\u2217 l \u222b Dz1Dz2 ( z1 \u2212 c\u2217\u221a 1\u2212 (c\u2217)2 z2 ) \u03c6(u\u22171)\u03c6 \u2032(u\u22172) (36)\n= c\u2217 + \u03c32w\u221a q\u2217 l\n[\u222b Dz1Dz2z1\u03c6(u\u22171)\u03c6\u2032(u\u22172)\u2212\nc\u2217\u221a 1\u2212 (c\u2217)2\n\u222b Dz1Dz2z2\u03c6(u\u22171)\u03c6\u2032(u\u22172) ] (37)\n= c\u2217 + \u03c32w l [\u222b Dz1Dz2(\u03c6\u2032(u\u22171)\u03c6\u2032(u\u22172) + c\u2217\u03c6(u\u22171)\u03c6\u2032\u2032(u\u22172))\u2212 c\u2217 \u222b Dz1Dz2\u03c6(u\u22171)\u03c6\u2032\u2032(u\u22172) ] (38)\n= c\u2217 + \u03c32w l \u222b Dz1Dz2\u03c6\u2032(u\u22171)\u03c6\u2032(u\u22172). (39)\nwhere u\u22171 and u \u2217 2 are appropriately defined asymptotic random variables. This leads to the asymptotic recurrence relation,\nl+1 = \u03c32w l \u222b Dz1Dz2\u03c6\u2032(u\u22171)\u03c6\u2032(u\u22172) (40)\nas required.\nWe now consider the case where c\u2217 = 1 and clab = 1 \u2212 l. In this case the expansion of ul2 will become,\nul2 = \u221a q\u2217z1 + \u221a 2q\u2217 lz2 \u2212 \u221a q\u2217 lz1 +O( 3/2) (41)\nand so the lowest order correction is of orderO( \u221a l) as opposed toO( l). As usual we now expand the recurrence relation, noting that u\u22172 = u \u2217 1 is independent of z2 when c \u2217 = 1 to find,\ncl+1ab = \u03c32w q\u2217\n\u222b Dz1Dz2\u03c6(u\u22171)\u03c6(ul2) + \u03c32b (42)\n\u2248 \u03c3 2 w\nq\u2217\n\u222b Dz1Dz2\u03c6(u\u22171) [ \u03c6(u\u22172) + (\u221a 2q\u2217 lz2 \u2212 \u221a q\u2217 lz1 ) \u03c6\u2032(u\u22172) + q \u2217 lz22\u03c6 \u2032\u2032(u\u22172) ] + \u03c32b\n(43)\n= c\u2217 + \u03c32w l\n\u222b Dz\u03c6(\u221aq\u2217z) [ \u03c6\u2032\u2032( \u221a q\u2217z)\u2212 1\u221a\nq\u2217 z\u03c6\u2032( \u221a q\u2217z)\n] (44)\n= c\u2217 + \u03c32w l\n[\u222b Dz\u03c6(\u221aq\u2217z)\u03c6\u2032\u2032(\u221aq\u2217z)\u2212 1\u221a\nq\u2217\n\u222b Dzz\u03c6(\u221aq\u2217z)\u03c6\u2032(\u221aq\u2217z) ] (45)\n= c\u2217 \u2212 \u03c32w l \u222b Dz [ \u03c6\u2032( \u221a q\u2217z) ]2 (46)\nIt follows that the asymptotic recurrence relation in this case will be, l+1 = \u2212 l\u03c32w \u222b Dz [ \u03c6\u2032( \u221a q\u2217z) ]2 = \u2212 l\u03c71. (47)\nwhere \u03c71 is the stability condition for the ordered phase. We note that although the approximations were somewhat different the asymptotic recurrence relation for c\u2217 < 1 reduces eq. 47 result for c\u2217 = 1. We may therefore use 4 for all c\u2217."}, {"heading": "7.3 VARIANCE OF AN INPUT WITH DROPOUT", "text": "Result:\nIn the presence of dropout with rate \u03c1, the variance of a single input as it is passed through the network is described by the recurrence relation,\nq\u0304laa = \u03c32w \u03c1\n\u222b Dz\u03c62 (\u221a q\u0304l\u22121aa z ) + \u03c32b . (48)"}, {"heading": "Derivation:", "text": "Recall that the recurrence relation for the pre-activations is given by,\nzli = 1\n\u03c1 \u2211 j W lijp l jy l j + b l i (49)\nwhere plj \u223c Bernoulli(\u03c1). It follows that the variance will be given by,\nq\u0304laa = E[(zli)2] (50)\n= 1\n\u03c12 \u2211 j E[(W lij)2]E[(\u03c1lj)2]E[(ylj)2] + E[(bli)2] (51)\n= \u03c32w \u03c1\n\u222b Dz\u03c62 (\u221a q\u0304l\u22121aa z ) + \u03c32b . (52)\nwhere we have used the fact that E[(plj)2] = \u03c1."}, {"heading": "7.4 COVARIANCE OF TWO INPUTS WITH DROPOUT", "text": ""}, {"heading": "Result:", "text": "The co-variance between two signals, zli;a and z l i;b, with separate i.i.d. dropout masks p l i;a and p l i;b is given by,\nq\u0304lab = \u03c3 2 w \u222b Dz1Dz2\u03c6(u\u03041)\u03c6(u\u03042) + \u03c32b . (53)\nwhere, in analogy to eq. 4, u\u03041 = \u221a q\u0304laaz1 and u\u03042 = \u221a q\u0304lbb ( c\u0304labz1 + \u221a 1\u2212 (c\u0304lab)2z2 ) ."}, {"heading": "Derivation:", "text": "Proceeding directly we find that,\nE[zli;azli;b] = 1\n\u03c12 \u2211 j E[(W lij)2]E[plj;a]E[plj;b]E[ylj;aylj;b] + E[bli] (54)\n= \u03c32w \u222b Dz1Dz2\u03c6(u\u03041)\u03c6(u\u03042) + \u03c32b (55)\nwhere we have used the fact that E[pli;a] = E[pli;b] = \u03c1. We have also used the same substitution for E[ylj;aylj;b] used in the original mean field calculation with the appropriate substitution.\n7.5 THE LACK OF A c\u2217 = 1 FIXED POINT WITH DROPOUT"}, {"heading": "Result:", "text": "If clab = 1 then it follows that,\nc\u0304l+1ab = 1\u2212 1\u2212 \u03c1 \u03c1q\u0304\u2217 \u03c32w\n\u222b Dz\u03c62 (\u221a q\u0304\u2217z )\n(56)\nsubject to the approximation, qlaa \u2248 qlbb \u2248 q\u2217. This implies that cl+1ab < 1. Derivation:\nPlugging in clab = 1 with q l aa \u2248 qlbb \u2248 q\u2217 we find that u\u03041 = u\u03042 = \u221a q\u2217z1. It follows that,\ncl+1ab = ql+1ab q\u2217\n(57)\n= 1\nq\u2217\n[ \u03c32w \u222b Dz\u03c62 (\u221a q\u2217z ) + \u03c32b ] (58)\n= 1\nq\u2217\n[ \u03c32w(1\u2212 \u03c1\u22121 + \u03c1\u22121) \u222b Dz\u03c62 (\u221a q\u2217z ) + \u03c32b ] (59)\n= 1\nq\u2217 [ \u03c32w \u03c1 \u222b Dz\u03c62 (\u221a q\u2217z ) + \u03c32b ] + \u03c32w q\u2217 (1\u2212 \u03c1\u22121) \u222b Dz\u03c62 (\u221a q\u2217z )\n(60)\n= 1\u2212 1\u2212 \u03c1 \u03c1q\u0304\u2217 \u03c32w\n\u222b Dz\u03c62 (\u221a q\u0304\u2217z )\n(61)\nas required. Here we have integrated out z2 since nether u\u03041 nor u\u03042 depend on it."}, {"heading": "7.6 MEAN FIELD GRADIENT SCALING", "text": ""}, {"heading": "Result:", "text": "In mean field theory the expected magnitude of the gradient ||\u2207W lijE|| 2 will be proportional to E[(\u03b4li)2]."}, {"heading": "Derivation:", "text": "We first note that since the W lij are i.i.d. it follows that,\n||\u2207W lijE|| 2 = \u2211 ij\n( \u2202E\n\u2202W lij\n)2 (62)\n\u2248 NlNl+1E ( \u2202E \u2202W lij )2 (63) where we have used the fact that the first line is related to the sample expectation over the different realizations of theW lij to approximate it by the analytic expectation in the second line. In mean field theory since the pre-activations in each layer are assumed to be i.i.d. Gaussian it follows that,\nE ( \u2202E \u2202W lij )2 = E[(\u03b4li)2]E[\u03c62(zl\u22121j )] (64) and the result follows."}, {"heading": "7.7 MEAN FIELD BACKPROPAGATION", "text": ""}, {"heading": "Result:", "text": "In mean field theory the recursion relation for the variance of the errors, q\u0303 l = E[(\u03b4li)2] is given by,\nq\u0303 laa = q\u0303 l+1 aa Nl+1 Nl+2 \u03c71(q l aa). (65)\nDerivation:\nComputing the variance directly and using mean field approximation, q\u0303 laa = E[(\u03b4li;a)2] = E[(\u03c6\u2032(zli;a))2] \u2211 j E[(\u03b4l+1j;a ) 2]E[(W l+1ji ) 2] (66)\n= E[(\u03c6\u2032(zli;a))2] \u03c32w Nl+1 \u2211 j E[(\u03b4l+1j;a ) 2] (67)\n= E[(\u03c6\u2032(zli;a))2] Nl+1 Nl+2 \u03c32w q\u0303 l+1 aa (68)\n= \u03c32w q\u0303 l+1 aa Nl+1 Nl+2\n\u222b Dz [ \u03c6\u2032 (\u221a\nqlaaz\n)]2 (69)\n\u2248 q\u0303 l+1aa Nl+1 Nl+2 \u03c71 (70)\nas required. In the last step we have made the approximation that qlaa \u2248 q\u2217 since the depth scale for the variance is short ranged."}, {"heading": "7.8 MEAN FIELD GRADIENT COVARIANCE SCALING", "text": ""}, {"heading": "Result:", "text": "In mean field theory we expect the covariance between the gradients of two different inputs to scale as,\n(\u2207W lijEa) \u00b7 (\u2207W lijEb) \u223c E[\u03b4i;a\u03b4i;b]. (71)"}, {"heading": "Derivation:", "text": "We proceed in a manner analogous to Appendix 7.6. Note that in mean field theory since the weights are i.i.d. it follows that\n(\u2207W lijEa) \u00b7 (\u2207W lijEb) = \u2211 ij \u2202Ea \u2202W lij \u2202Eb \u2202W lij\n(72)\n\u2248 NlNl+1E [ \u2202Ea \u2202W lij \u2202Eb \u2202W lij ] (73)\nwhere, as before, the final term is approximating the sample expectation. Since the weights in the forward and backwards passes are chosen independently it follows that we can factor the expectation as,\nE [ \u2202Ea \u2202W lij \u2202Eb \u2202W lij ] = E[\u03b4li;a\u03b4li;b]E[\u03c6(zli;a)\u03c6(zli;b)] (74)\nand the result follows."}, {"heading": "7.9 MEAN FIELD BACKPROPAGATION OF COVARIANCE", "text": ""}, {"heading": "Result:", "text": "The covariance between the gradients due to two inputs scales as,\nq\u0303 lab = q\u0303 l+1 ab Nl+1 Nl+2 \u03c32w\n\u222b Dz1Dz2\u03c6\u2032(u1)\u03c6\u2032(u2) (75)\nunder backpropagation."}, {"heading": "Derivation", "text": "As in the analogous derivation for the variance, we compute directly, q\u0303 lab = E[\u03b4li;a\u03b4li;b] = E [\u03c6\u2032(zi;a)\u03c6\u2032(zi;b)] \u2211 j E[\u03b4l+1j;a \u03b4 l+1 j;b ]E[(W l+1 ji ) 2] (76)\n= q\u0303 l+1ab Nl+1 Nl+2 \u03c32w\n\u222b Dz1Dz2\u03c6\u2032(u1)\u03c6\u2032(u2) (77)\nas required."}, {"heading": "7.10 FURTHER EXPERIMENTAL RESULTS", "text": "Here we include some more experimental figures that investigate the effects of training time, minimizer, and dataset more closely."}], "references": [{"title": "The problem of learning long-term dependencies in recurrent networks", "author": ["Y Bengio", "Paolo Frasconi", "P Simard"], "venue": "In Neural Networks,", "citeRegEx": "Bengio et al\\.,? \\Q1993\\E", "shortCiteRegEx": "Bengio et al\\.", "year": 1993}, {"title": "At the edge of chaos: Real-time computations and self-organized criticality in recurrent neural networks", "author": ["Nils Bertschinger", "Thomas Natschl\u00e4ger", "Robert A. Legenstein"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "Bertschinger et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Bertschinger et al\\.", "year": 2005}, {"title": "The loss surfaces of multilayer networks", "author": ["Anna Choromanska", "Mikael Henaff", "Michael Mathieu", "G\u00e9rard Ben Arous", "Yann LeCun"], "venue": "In AISTATS,", "citeRegEx": "Choromanska et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Choromanska et al\\.", "year": 2015}, {"title": "Toward Deeper Understanding of Neural Networks: The Power of Initialization and a Dual View on Expressivity", "author": ["A. Daniely", "R. Frostig", "Y. Singer"], "venue": null, "citeRegEx": "Daniely et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Daniely et al\\.", "year": 2016}, {"title": "Understanding the difficulty of training deep feedforward neural networks", "author": ["Xavier Glorot", "Yoshua Bengio"], "venue": "In Aistats,", "citeRegEx": "Glorot and Bengio.,? \\Q2010\\E", "shortCiteRegEx": "Glorot and Bengio.", "year": 2010}, {"title": "Qualitatively characterizing neural network optimization problems", "author": ["Ian J Goodfellow", "Oriol Vinyals", "Andrew M Saxe"], "venue": null, "citeRegEx": "Goodfellow et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Goodfellow et al\\.", "year": 2014}, {"title": "Deep Residual Learning for Image Recognition", "author": ["K. He", "X. Zhang", "S. Ren", "J. Sun"], "venue": "ArXiv e-prints,", "citeRegEx": "He et al\\.,? \\Q2015\\E", "shortCiteRegEx": "He et al\\.", "year": 2015}, {"title": "Batch normalization: Accelerating deep network training by reducing internal covariate shift", "author": ["Sergey Ioffe", "Christian Szegedy"], "venue": "In Proceedings of The 32nd International Conference on Machine Learning,", "citeRegEx": "Ioffe and Szegedy.,? \\Q2015\\E", "shortCiteRegEx": "Ioffe and Szegedy.", "year": 2015}, {"title": "Random feedback weights support learning in deep neural networks", "author": ["Timothy P Lillicrap", "Daniel Cownden", "Douglas B Tweed", "Colin J Akerman"], "venue": null, "citeRegEx": "Lillicrap et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Lillicrap et al\\.", "year": 2014}, {"title": "On the number of linear regions of deep neural networks", "author": ["Guido F Montufar", "Razvan Pascanu", "Kyunghyun Cho", "Yoshua Bengio"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "Montufar et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Montufar et al\\.", "year": 2014}, {"title": "Bayesian learning for neural networks, volume 118", "author": ["Radford M Neal"], "venue": "Springer Science & Business Media,", "citeRegEx": "Neal.,? \\Q2012\\E", "shortCiteRegEx": "Neal.", "year": 2012}, {"title": "Exponential expressivity in deep neural networks through transient chaos", "author": ["B. Poole", "S. Lahiri", "M. Raghu", "J. Sohl-Dickstein", "S. Ganguli"], "venue": null, "citeRegEx": "Poole et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Poole et al\\.", "year": 2016}, {"title": "On the expressive power of deep neural networks", "author": ["M. Raghu", "B. Poole", "J. Kleinberg", "S. Ganguli", "J. Sohl-Dickstein"], "venue": null, "citeRegEx": "Raghu et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Raghu et al\\.", "year": 2016}, {"title": "Train faster, generalize better: Stability of stochastic gradient descent", "author": ["Benjamin Recht", "Moritz Hardt", "Yoram Singer"], "venue": null, "citeRegEx": "Recht et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Recht et al\\.", "year": 2015}, {"title": "Exact solutions to the nonlinear dynamics of learning in deep linear neural networks", "author": ["A.M. Saxe", "J.L. McClelland", "S. Ganguli"], "venue": "International Conference on Learning Representations,", "citeRegEx": "Saxe et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Saxe et al\\.", "year": 2014}, {"title": "Random walks: Training very deep nonlinear feed-forward networks with smart initialization", "author": ["David Sussillo", "LF Abbott"], "venue": "CoRR, vol. abs/1412.6558,", "citeRegEx": "Sussillo and Abbott.,? \\Q2014\\E", "shortCiteRegEx": "Sussillo and Abbott.", "year": 2014}], "referenceMentions": [{"referenceID": 9, "context": "The success of deep networks is due to the fact that they are highly expressive (Montufar et al., 2014) while simultaneously being relatively easy to optimize (Choromanska et al.", "startOffset": 80, "endOffset": 103}, {"referenceID": 2, "context": ", 2014) while simultaneously being relatively easy to optimize (Choromanska et al., 2015; Goodfellow et al., 2014) with strong generalization properties (Recht et al.", "startOffset": 63, "endOffset": 114}, {"referenceID": 5, "context": ", 2014) while simultaneously being relatively easy to optimize (Choromanska et al., 2015; Goodfellow et al., 2014) with strong generalization properties (Recht et al.", "startOffset": 63, "endOffset": 114}, {"referenceID": 13, "context": ", 2014) with strong generalization properties (Recht et al., 2015).", "startOffset": 46, "endOffset": 66}, {"referenceID": 11, "context": "A pair of recent papers (Poole et al., 2016; Raghu et al., 2016) demonstrated that random neural networks are exponentially expressive in their depth.", "startOffset": 24, "endOffset": 64}, {"referenceID": 12, "context": "A pair of recent papers (Poole et al., 2016; Raghu et al., 2016) demonstrated that random neural networks are exponentially expressive in their depth.", "startOffset": 24, "endOffset": 64}, {"referenceID": 0, "context": "phenomenon that has long been observed in neural networks (Bengio et al., 1993).", "startOffset": 58, "endOffset": 79}, {"referenceID": 14, "context": "(2005); Glorot & Bengio (2010) or indirect, through initialization schemes that favor deep signal propagation such as batch normalization (Ioffe & Szegedy, 2015), orthogonal matrix initialization (Saxe et al., 2014), random walk initialization (Sussillo & Abbott, 2014), composition kernels (Daniely et al.", "startOffset": 196, "endOffset": 215}, {"referenceID": 3, "context": ", 2014), random walk initialization (Sussillo & Abbott, 2014), composition kernels (Daniely et al., 2016), or residual network architectures (He et al.", "startOffset": 83, "endOffset": 105}, {"referenceID": 6, "context": ", 2016), or residual network architectures (He et al., 2015).", "startOffset": 43, "endOffset": 60}, {"referenceID": 8, "context": "This approximation is similar in spirit to the vanilla mean field approximation and is reminiscent of work on feedback alignment (Lillicrap et al., 2014).", "startOffset": 129, "endOffset": 153}, {"referenceID": 10, "context": "An alternative perspective as to why information stored in the covariance between inputs is crucial for training can be understood by appealing to the correspondence between infinitely wide Bayesian neural networks and Gaussian Processes (Neal, 2012).", "startOffset": 238, "endOffset": 250}], "year": 2017, "abstractText": "We study the behavior of untrained neural networks whose weights and biases are randomly distributed using mean field theory. We show the existence of depth scales that naturally limit the maximum depth of signal propagation through these random networks. Our main practical result is to show that random networks may be trained precisely when information can travel through them. Thus, the depth scales that we identify provide bounds on how deep a network may be trained for a specific choice of hyperparameters. As a corollary to this, we argue that in networks at the edge of chaos, one of these depth scales diverges. Thus arbitrarily deep networks may be trained only sufficiently close to criticality. We show that the presence of dropout destroys the order-to-chaos critical point and therefore strongly limits the maximum trainable depth for random networks. Finally, we develop a mean field theory for backpropagation and we show that the ordered and chaotic phases correspond to regions of vanishing and exploding gradient respectively.", "creator": "LaTeX with hyperref package"}, "id": "ICLR_2017_146"}